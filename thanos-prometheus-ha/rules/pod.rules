groups:
- name: prometheus
  rules:

#  - alert: pod_memory_fail
#    expr: rate(container_memory_failcnt{image!=""}[5m]) > 0
#    for: 5m
#    labels:
#      severity: critical
#    annotations:
#      description: "容器 {{ $labels.name }} 申请内存失败 , (current count is {{ $value }})"
#      summary: "内存申请失败告警"

  - alert: PodStatusNotRunning
#    expr: kube_pod_status_phase{namespace="baas",phase=~"Failed|Unknown"} == 1 or kube_pod_status_phase{namespace="paas",phase=~"Failed|Unknown"} == 1 or kube_pod_status_phase{namespace="monitor",phase=~"Failed|Unknown"} == 1  or kube_pod_status_phase{environment="prod",namespace="default",phase=~"Failed|Unknown"} == 1  or kube_pod_status_phase{environment="prod",namespace="cbl",phase=~"Failed|Unknown"} == 1 
    expr: kube_pod_status_phase{namespace="baas|paas|default|monitor",phase=~"Failed|Unknown|Evicted"} == 1
    for: 5m
    labels:
      severity: warning
    annotations:
      description: Pod {{ $labels.pod }} in {{ $labels.environment }}.{{ $labels.namespace }} is not running.
